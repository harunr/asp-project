/*!
 * Waterwheel Carousel
 * Version 2.3.0
 * http://www.bkosborne.com
 *
 * Copyright 2011-2013 Brian Osborne
 * Dual licensed under GPLv3 or MIT
 * Copies of the licenses have been distributed
 * with this plugin.
 *
 * Plugin written by Brian Osborne
 * for use with the jQuery JavaScript Framework
 * http://www.jquery.com
 */
;
!function(t){"use strict";t.fn.waterwheelCarousel=function(e){function i(){(C={itemsContainer:t(v),totalItems:t(v).children().length,containerWidth:t(v).width(),containerHeight:t(v).height(),currentCenterItem:null,previousCenterItem:null,items:[],calculations:[],carouselRotationsLeft:0,currentlyMoving:!1,itemsAnimating:0,currentSpeed:I.speed,intervalTimer:null,currentDirection:"forward",leftItemsCount:0,rightItemsCount:0,performingSetup:!0}).itemsContainer.children().removeClass(I.activeClassName)}function a(t){clearTimeout(C.autoPlayTimer),t||0===I.autoPlay||(C.autoPlayTimer=setTimeout(function(){p(I.autoPlay>0?"forward":"backward")},Math.abs(I.autoPlay)))}function n(e){var i=C.itemsContainer.find("img"),a=i.length,n=0;!1!==I.preloadImages&&0!==i.length?i.each(function(){t(this).bind("load",function(){(n+=1)!==a||e()}),t(this).attr("src",t(this).attr("src")),this.complete&&t(this).trigger("load")}):e()}function r(){C.itemsContainer.children().each(function(){(void 0==t(this).data("original_width")||I.forcedImageWidth>0)&&t(this).data("original_width",t(this).width()),(void 0==t(this).data("original_height")||I.forcedImageHeight>0)&&t(this).data("original_height",t(this).height())})}function o(){I.forcedImageWidth&&I.forcedImageHeight&&C.itemsContainer.children().each(function(){t(this).width(I.forcedImageWidth),t(this).height(I.forcedImageHeight)})}function s(){C.itemsContainer.children().eq(0);C.calculations[0]={distance:0,offset:0,opacity:1};for(var t=I.horizonOffset,e=I.separation,i=1;i<=I.flankingItems+2;i++)i>1&&(t*=I.horizonOffsetMultiplier,e*=I.separationMultiplier),C.calculations[i]={distance:C.calculations[i-1].distance+e,offset:C.calculations[i-1].offset+t,opacity:C.calculations[i-1].opacity*I.opacityMultiplier};I.edgeFadeEnabled?C.calculations[I.flankingItems+1].opacity=0:C.calculations[I.flankingItems+1]={distance:0,offset:0,opacity:0}}function c(){C.items=C.itemsContainer.children();for(var e=0;e<C.totalItems;e++)C.items[e]=t(C.items[e]);0===I.horizon&&("horizontal"===I.orientation?I.horizon=C.containerHeight/2:I.horizon=C.containerWidth/2),C.itemsContainer.css("position","relative").children().each(function(){var e,i;"horizontal"===I.orientation?(e=C.containerWidth/2-t(this).data("original_width")/2,i=I.horizon-t(this).data("original_height")/2):(e=I.horizon-t(this).data("original_width")/2,i=C.containerHeight/2-t(this).data("original_height")/2),t(this).css({left:e,top:i,visibility:"visible",position:"absolute","z-index":0,opacity:0}).data({top:i,left:e,oldPosition:0,currentPosition:0,depth:0,opacity:0}).show()})}function l(){I.startingItem=0===I.startingItem?Math.round(C.totalItems/2):I.startingItem,C.rightItemsCount=Math.ceil((C.totalItems-1)/2),C.leftItemsCount=Math.floor((C.totalItems-1)/2),C.carouselRotationsLeft=1,d(C.items[I.startingItem-1],0),C.items[I.startingItem-1].css("opacity",1);for(var t=I.startingItem-1,e=1;e<=C.rightItemsCount;e++)t<C.totalItems-1?t+=1:t=0,C.items[t].css("opacity",1),d(C.items[t],e);for(var t=I.startingItem-1,e=-1;e>=-1*C.leftItemsCount;e--)t>0?t-=1:t=C.totalItems-1,C.items[t].css("opacity",1),d(C.items[t],e)}function h(t,e){var i=Math.abs(e);if(i<I.flankingItems+1)a=C.calculations[i];else var a=C.calculations[I.flankingItems+1];var n=Math.pow(I.sizeMultiplier,i),r=n*t.data("original_width"),o=n*t.data("original_height"),s=Math.abs(t.width()-r),c=Math.abs(t.height()-o),l=a.offset,h=a.distance;if(e<0&&(h*=-1),"horizontal"==I.orientation)var d=(m=C.containerWidth/2)+h-r/2,u=I.horizon-l-o/2;else var m=C.containerHeight/2,d=I.horizon-l-r/2,u=m+h-o/2;u-=c/2,d-=s/2;var f;f=0===e?1:a.opacity;var g=I.flankingItems+2-i;t.data("width",r),t.data("height",o),t.data("top",u),t.data("left",d),t.data("oldPosition",t.data("currentPosition")),t.data("depth",g),t.data("opacity",f),t.data("distanceFactor",n)}function d(t,e){Math.abs(e)<=I.flankingItems+1?(h(t,e),C.itemsAnimating++,t.css("z-index",t.data().depth).animate({left:t.data().left,top:t.data().top,opacity:t.data().opacity},C.currentSpeed,I.animationEasing,function(){u(t,e)}),TweenMax.to(t,C.currentSpeed/1e3,{scaleX:t.data("distanceFactor"),scaleY:t.data("distanceFactor"),ease:I.animationEasing})):(t.data("currentPosition",e),0===t.data("oldPosition")&&(t.css({left:t.data().left,top:t.data().top,opacity:t.data().opacity,"z-index":t.data().depth}),TweenMax.to(t,0,{scaleX:t.data("distanceFactor"),scaleY:t.data("distanceFactor")})))}function u(t,e){C.itemsAnimating--,t.data("currentPosition",e),0===e&&(C.currentCenterItem=t),0===C.itemsAnimating&&(C.carouselRotationsLeft-=1,C.currentlyMoving=!1,C.carouselRotationsLeft>0?m(0):(C.currentSpeed=I.speed,C.currentCenterItem.addClass(I.activeClassName),!1===C.performingSetup&&(I.movedToCenter(C.currentCenterItem),I.movedFromCenter(C.previousCenterItem)),C.performingSetup=!1,a()))}function m(e){if(!1===C.currentlyMoving){C.currentCenterItem.removeClass(I.activeClassName),C.currentlyMoving=!0,C.itemsAnimating=0,C.carouselRotationsLeft+=e,!0===I.quickerForFurther&&(e>1&&(C.currentSpeed=I.speed/e),C.currentSpeed=C.currentSpeed<100?100:C.currentSpeed);for(var i=0;i<C.totalItems;i++){var a,n=t(C.items[i]),r=n.data("currentPosition"),o=(a="forward"==C.currentDirection?r-1:r+1)>0?C.rightItemsCount:C.leftItemsCount;Math.abs(a)>o&&(a=-1*r,C.totalItems%2==0&&(a+=1)),d(n,a)}}}function f(){var t=C.currentCenterItem.next();return t.length<=0&&(t=C.currentCenterItem.parent().children().first()),t}function g(){var t=C.currentCenterItem.prev();return t.length<=0&&(t=C.currentCenterItem.parent().children().last()),t}function p(t){!1===C.currentlyMoving&&(C.previousCenterItem=C.currentCenterItem,I.movingFromCenter(C.currentCenterItem),"backward"==t?(I.movingToCenter(g()),C.currentDirection="backward"):"forward"==t&&(I.movingToCenter(f()),C.currentDirection="forward")),m(1)}if(this.length>1)return this.each(function(){t(this).waterwheelCarousel(e)}),this;var v=this,I={},C={};return t(this).children().bind("click",function(){var e=t(this).data().currentPosition;if(0!=I.imageNav&&!(Math.abs(e)>=I.flankingItems+1||C.currentlyMoving)){C.previousCenterItem=C.currentCenterItem,a(!0),I.autoPlay=0;var i=Math.abs(e);0==e?I.clickedCenter(t(this)):(I.movingFromCenter(C.currentCenterItem),I.movingToCenter(t(this)),e<0?(C.currentDirection="backward",m(i)):e>0&&(C.currentDirection="forward",m(i)))}}),t(document).keydown(function(t){if(I.keyboardNav&&(37===t.which&&"horizontal"==I.orientation||38===t.which&&"vertical"==I.orientation?(a(!0),I.autoPlay=0,p("backward")):(39===t.which&&"horizontal"==I.orientation||40===t.which&&"vertical"==I.orientation)&&(a(!0),I.autoPlay=0,p("forward")),I.keyboardNavOverride&&("horizontal"==I.orientation&&(37===t.which||39===t.which)||"vertical"==I.orientation&&(38===t.which||40===t.which))))return t.preventDefault(),!1}),this.reload=function(e){if("object"==typeof e);else;I=t.extend({},t.fn.waterwheelCarousel.defaults,e),i(),C.itemsContainer.children().hide(),o(),n(function(){r(),s(),c(),l()})},this.next=function(){a(!0),I.autoPlay=0,p("forward")},this.prev=function(){a(!0),I.autoPlay=0,p("backward")},this.reload(e),this},t.fn.waterwheelCarousel.defaults={startingItem:1,separation:175,separationMultiplier:.6,horizonOffset:0,horizonOffsetMultiplier:1,sizeMultiplier:.7,opacityMultiplier:.8,horizon:0,flankingItems:3,speed:300,animationEasing:"linear",quickerForFurther:!0,edgeFadeEnabled:!1,linkHandling:2,autoPlay:0,orientation:"horizontal",activeClassName:"carousel-center",keyboardNav:!1,keyboardNavOverride:!0,imageNav:!0,preloadImages:!0,forcedImageWidth:0,forcedImageHeight:0,movingToCenter:t.noop,movedToCenter:t.noop,clickedCenter:t.noop,movingFromCenter:t.noop,movedFromCenter:t.noop}}(jQuery);
